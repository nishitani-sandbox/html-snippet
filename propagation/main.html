<!DOCTYPE html>
<html lang="en">
<head>
<title>Event Propagation</title>
</head>
<body>

<h1>
    Event Propagation Sample
</h1>

<div>
    <button>click</button>
</div>

<script>
    const eventPhaseName = e => {
        switch (e.eventPhase) {
        case 1:
            return 'capturing';
        case 2:
            return 'target';
        case 3:
            return 'bubbling';
        default:
            return 'none';
        }
    };
    document.body.addEventListener('click', e => {
        console.log(`body: in ${eventPhaseName(e)} phase`);
    }, true);
    document.body.addEventListener('click', e => {
        console.log(`body: in ${eventPhaseName(e)} phase`);
    });
    const div = document.querySelector('div');
    div.addEventListener('click', e => {
        console.log(`div: in ${eventPhaseName(e)} phase`);
    }, true);
    div.addEventListener('click', e => {
        console.log(`div: in ${eventPhaseName(e)} phase`);
    });
    // event targetの場合、trueつけた方がtarget phaseの最初に呼ばれる
    const button = document.querySelector('button');
    button.addEventListener('click', e => {
        console.log(`button: in ${eventPhaseName(e)} phase`);
    }, true);
    button.addEventListener('click', e => {
        console.log(`button: in ${eventPhaseName(e)} phase`);
    });
</script>

<h1>ref</h1>
<ul>
    <li>
        <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events">Introduction to events</a>
    </li>
    <li>
        <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener">EventTarget.addEventListener()</a>
    </li>
    <li>
        <a href="https://developer.mozilla.org/en-US/docs/Web/API/Event/eventPhase">Event.eventPhase</a>
    </li>
</ul>

</body>
</html>
